# Health check configuration - prioridad alta
# Esta configuración debe aplicarse antes que otras reglas

# Server para el health check
server {
    # Configuración básica
    listen 8443 ssl;
    server_name localhost;

    # SSL configuration (debe coincidir con la configuración principal)
    ssl_certificate /tmp/ssl/transcendence.crt;
    ssl_certificate_key /tmp/ssl/transcendence.key;
    ssl_protocols TLSv1.2 TLSv1.3;

    # Endpoint health check - respuesta directa
    location = /health {
        access_log off;
        add_header Content-Type text/plain;
        add_header X-Health-Check "direct-response";
        return 200 'OK';
    }
    
    # Captura también /health/ con barra al final
    location ^~ /health/ {
        access_log off;
        add_header Content-Type text/plain;
        add_header X-Health-Check "direct-response";
        return 200 'OK';
    }
}
