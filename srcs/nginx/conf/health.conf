# Health check configuration - high priority
# This configuration should be applied before other rules

# Server for health check
server {
    # Basic configuration
    listen 8443 ssl;
    server_name localhost;

    # SSL configuration (must match main configuration)
    ssl_certificate /tmp/ssl/transcendence.crt;
    ssl_certificate_key /tmp/ssl/transcendence.key;
    ssl_protocols TLSv1.2 TLSv1.3;

    # Health check endpoint - direct response
    location = /health {
        access_log off;
        add_header Content-Type text/plain;
        add_header X-Health-Check "direct-response";
        return 200 'OK';
    }
    
    # Also handle /health/ with trailing slash
    location ^~ /health/ {
        access_log off;
        add_header Content-Type text/plain;
        add_header X-Health-Check "direct-response";
        return 200 'OK';
    }
}
